<div class="profile-bookmark-list">
  <% current_user.liking_heritages.each do |heritage| %>
    <!--PC版-->
    <%= link_to heritage_path(heritage), class: "profile-heritage-card" do %>
      <%= image_tag heritage.image_path, class: "profile-heritage-card__image" %>
      <div class="profile-heritage-card__heritage-name">
        <%= heritage.name %>
      </div>
      <div class="profile-heritage-card__country">
        <%= image_tag "location.png", size: "20x20" %>
        <%= heritage.country.name %>
      </div>
      <div class="profile-heritage-card__review-score">
        <%= image_tag "review_score/score0.png", size: "100x20" %>
        <span class="js-score" data-score="<%= calc_average_review_score(heritage.id) %>">
          <%= calc_average_review_score(heritage.id) %>
        </span>
      </div>
      <div class="profile-heritage-card__bookmark-img">
        <%= image_tag "bookmark.svg", size: "30x30" %>
      </div>
    <% end %>
  <% end %>
  <!--スマホ版-->
  <% current_user.liking_heritages.each do |heritage| %>
    <%= link_to heritage_path(heritage), class: "profile-heritage-mobile-card" do %>
      <div class="profile-heritage-mobile-card__image">
        <%= image_tag heritage.image_path %>
      </div>
      <div class="heritage-mobile-card-details">
        <div class="heritage-mobile-card-details__heritage-name">
          <%= heritage.name %>
        </div>
        <div class="heritage-mobile-card-details__country">
          <%= image_tag "location.png", size: "20x20" %>
          <%= heritage.country.name %>
        </div>
        <div class="heritage-mobile-card-details__review-score">
          <%= image_tag "review_score/score0.png", size: "100x20" %>
          <span class="js-score" data-score="<%= calc_average_review_score(heritage.id) %>">
            <%= calc_average_review_score(heritage.id) %>
          </span>
        </div>
        <div class="heritage-card-tags-wrapper">
          <div class="heritage-tag-card">
            <%= image_tag "tag.svg", size: "20x20" %>
            <span class="heritage-tag-card__tag-name">寺院</span>
          </div>
          <div class="heritage-tag-card">
            <%= image_tag "tag.svg", size: "20x20" %>
            <span class="heritage-tag-card__tag-name">自然</span>
          </div>
          <div class="heritage-tag-card">
            <%= image_tag "tag.svg", size: "20x20" %>
            <span class="heritage-tag-card__tag-name">入場料無料</span>
          </div>
          <div class="heritage-tag-card">
            <%= image_tag "tag.svg", size: "20x20" %>
            <span class="heritage-tag-card__tag-name">美術館</span>
          </div>
        </div>
        <div class="heritage-mobile-card-details__bookmark-img">
          <%= image_tag "bookmark.svg", size: "30x30" %>
        </div>
      </div>
    <% end %>
  <% end %>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    var scoreElements = document.querySelectorAll('.js-score'); 
    scoreElements.forEach(function(scoreElement) {
      var score = scoreElement.dataset.score;
      var imgElement = scoreElement.previousElementSibling;
      if (score && imgElement) {
        if (score >= 0.5 && score < 1) {
            imgElement.src = "/assets/review_score/score05.png";
        } else if (score >= 1 && score < 1.5) {
            imgElement.src = "/assets/review_score/score10.png";
        } else if (score >= 1.5 && score < 2) {
            imgElement.src = "/assets/review_score/score15.png";
        } else if (score >= 2 && score < 2.5) {
            imgElement.src = "/assets/review_score/score20.png";
        } else if (score >= 2.5 && score < 3) {
            imgElement.src = "/assets/review_score/score25.png";
        } else if (score >= 3 && score < 3.5) {
            imgElement.src = "/assets/review_score/score30.png";
        } else if (score >= 3.5 && score < 4) {
            imgElement.src = "/assets/review_score/score35.png";
        } else if (score >= 4 && score < 4.5) {
            imgElement.src = "/assets/review_score/score40.png";
        } else if (score >= 4.5 && score < 5) {
            imgElement.src = "/assets/review_score/score45.png";
        } else if (score == 5) {
            imgElement.src = "/assets/review_score/score50.png";
        }
      }
    });
  });
</script>
